/*
*********************************************************************************************************
* INCLUDE FILES
*********************************************************************************************************
*/
#include "833et_table.h"

#define R833_TAB_LEN	55		//=((74-(-34)))/2+1)
#define R833_Offset		34		//-34C

#define COEF_R833	36
const unsigned int  R833ET[]={			//-34 ~ 74C. ROM
		65376	,// -34
	//	61452	,// -33
		57780	,// -32
	//	54360	,// -31
		51156	,// -30
	//	48132	,// -29
		45324	,// -28
	//	42660	,// -27
		40212	,// -26
	//	37872	,// -25
		35730	,// -24
	//	33706.8 ,// -23
		31817	,// -22
	//	30046	,// -21
		28386	,// -20
	//	26802	,// -19
		25319	,// -18
	//	23929	,// -17
		22622	,// -16
	//	21398	,// -15
		20250	,// -14
	//	19170	,// -13
		18158	,// -12
	//	17204	,// -11
		16308	,// -10
	//	15455	,// -9
		14648	,// -8
	//	13892	,// -7
		13183	,// -6
	//	12514	,// -5
		11880	,// -4
	//	11286	,// -3
		10724	,// -2
	//	10195	,// -1
		9695	,// 0
	//	9216	,// 1
		8762	,// 2
	//	8334	,// 3
		7931	,// 4
	//	7549	,// 5
		7189	,// 6
	//	6847	,// 7
		6527	,// 8
	//	6221	,// 9
		5933	,// 10
	//	5656	,// 11
		5393	,// 12
	//	5144	,// 13
		4907	,// 14
	//	4684	,// 15
		4475	,// 16
	//	4273	,// 17
		4082	,// 18
	//	3902	,// 19
		3730	,// 20
	//	3566	,// 21
		3410	,// 22
	//	3262	,// 23
		3122	,// 24
	//	2988	,// 25
		2860	,// 26
	//	2739	,// 27
		2623	,// 28
	//	2513	,// 29
		2409	,// 30
	//	2308	,// 31
		2212	,// 32
	//	2121	,// 33
		2034	,// 34
	//	1951	,// 35
		1872	,// 36
	//	1796	,// 37
		1724	,// 38
	//	1656	,// 39
		1590	,// 40
	//	1527	,// 41
		1467	,// 42
	//	1410	,// 43
		1355	,// 44
	//	1302	,// 45
		1252	,// 46
	//	1204	,// 47
		1158	,// 48
	//	1115	,// 49
		1073	,// 50
	//	1032	,// 51
		994 	,// 52
	//	957 	,// 53
		921 	,// 54
	//	887 	,// 55
		855 	,// 56
	//	824 	,// 57
		794 	,// 58
	//	766 	,// 59
		738 	,// 60
	//	712 	,// 61
		687 	,// 62
	//	662 	,// 63
		639 	,// 64
	//	617 	,// 65
		595 	,// 66
	//	575 	,// 67
		555 	,// 68
	//	536 	,// 69
		518 	,// 70
	//	500 	,// 71
		483 	,// 72
	//	467 	,// 73
		451 	,// 74
};
//===========================================================================
//----- calculating Temp from R833. need verification,verified on 8.Jun.2004
//===========================================================================
float R833_temp(float res)
{
	int i;		//not "uint".
	float tempf;

	res *= COEF_R833;	//not necessary //res *= (R833_GAIN/COEF_R833);
	for(i=0; i< R833_TAB_LEN; i++)	
	{
		if(res > (float)R833ET[i])	
		{
			break;
		}
	}
	tempf = (float)((i-1)*2-R833_Offset);	
	if((i>0) && (i<R833_TAB_LEN))
	{	
		tempf += 2*(((float)R833ET[i-1] - res)/(float)(R833ET[i-1] - R833ET[i]));	
	}		

	return(tempf);
}

float avgfilter(float prevalue, float curvalue, float interval, float filter_cnt)
{
	float tmpfloat;
	
	tmpfloat = curvalue - prevalue;
	
	if((tmpfloat < interval) && (tmpfloat > (-interval)))
	{
		curvalue = prevalue*(1.0-(1.0/filter_cnt)) + curvalue*(1.0/filter_cnt);	
	}
	
	return(curvalue);
}
//#endif


